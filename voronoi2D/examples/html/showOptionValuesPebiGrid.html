
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Example</title><meta name="generator" content="MATLAB 9.0"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-06-18"><meta name="DC.source" content="showOptionValuesPebiGrid.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Example</h1><!--introduction--><p>In this example we show all optional options for pebiGrid.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">wellLines</a></li><li><a href="#2">wellGridFactor</a></li><li><a href="#3">wellRefinement</a></li><li><a href="#4">wellEps</a></li><li><a href="#5">ProtLayer</a></li><li><a href="#6">protD</a></li><li><a href="#7">faultLines</a></li><li><a href="#8">faultGridFactor</a></li><li><a href="#9">circleFactor</a></li><li><a href="#10">faultRho</a></li><li><a href="#11">faultRefinement</a></li><li><a href="#12">faultEps</a></li></ul></div><h2>wellLines<a name="1"></a></h2><p>This sets the wells in our reservoir. The wells are stored as a cell array, each element corresponding to one well</p><pre class="codeinput">w = {[0.2,0.8;0.5,0.7;0.8,0.8],<span class="keyword">...</span>
     [0.5,0.2]};
gS = 0.1;
pdims=[1,1];
G = pebiGrid(gS, pdims,<span class="string">'wellLines'</span>,w);

plotGrid(G);
hold <span class="string">on</span>
plotGrid(G,G.cells.tag,<span class="string">'facecolor'</span>,<span class="string">'b'</span>)
title(<span class="string">'Two wells'</span>)
axis <span class="string">equal</span>
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_01.png" alt=""> <h2>wellGridFactor<a name="2"></a></h2><p>The wellGridFactor sets the relative size of the well cells. If wellGridFactor=0.5 the well cells will have about half the size of the reservoir sites:</p><pre class="codeinput">w = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
G1 = pebiGrid(gS, pdims,<span class="string">'wellLines'</span>,w,<span class="string">'wellGridFactor'</span>,1);
G2 = pebiGrid(gS, pdims,<span class="string">'wellLines'</span>,w,<span class="string">'wellGridFactor'</span>,1/2);

figure()
plotGrid(G1)
plotGrid(G1,G1.cells.tag,<span class="string">'faceColor'</span>,<span class="string">'b'</span>)
title(<span class="string">'wellGridFactor=1'</span>)
axis <span class="string">equal</span>
figure()
plotGrid(G2)
plotGrid(G2,G2.cells.tag,<span class="string">'faceColor'</span>,<span class="string">'b'</span>)
title(<span class="string">'wellGridFactor=1/2'</span>)
axis <span class="string">equal</span>
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_02.png" alt=""> <img vspace="5" hspace="5" src="showOptionValuesPebiGrid_03.png" alt=""> <h2>wellRefinement<a name="3"></a></h2><p>wellRefinement is a logical parameter which is set to true if we whish the grid to be refined towards the wells.</p><pre class="codeinput">w = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
G = pebiGrid(gS, pdims,<span class="string">'wellLines'</span>,w,<span class="string">'wellGridFactor'</span>,1/4,<span class="string">'wellRefinement'</span>,true);

figure()
plotGrid(G)
plotGrid(G,G.cells.tag,<span class="string">'faceColor'</span>,<span class="string">'b'</span>)
title(<span class="string">'wellRefinement'</span>)
axis <span class="string">equal</span>
</pre><pre class="codeoutput">Warning: DistMesh did not converge in maximum number of iterations. 
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_04.png" alt=""> <h2>wellEps<a name="4"></a></h2><p>wellEps controlls the refinement towards the wells. The cell sizes are increasing exponentially away from the wells: exp(dist(x,well)/wellEps). Notice that you have to scale wellEps to your reservoir size, or distMesh might take a very long time to converge.</p><pre class="codeinput">w = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
eps1 = 1/5;
eps2 = 1/2;
G1 = pebiGrid(gS, pdims,<span class="string">'wellLines'</span>,w,<span class="string">'wellGridFactor'</span>,1/4, <span class="keyword">...</span>
              <span class="string">'wellRefinement'</span>,true,<span class="string">'wellEps'</span>,eps1);
G2 = pebiGrid(gS, pdims,<span class="string">'wellLines'</span>,w,<span class="string">'wellGridFactor'</span>,1/4, <span class="keyword">...</span>
              <span class="string">'wellRefinement'</span>,true,<span class="string">'wellEps'</span>,eps2);

figure()
plotGrid(G1)
plotGrid(G1,G1.cells.tag,<span class="string">'faceColor'</span>,<span class="string">'b'</span>)
title(<span class="string">'wellEps = 1/5'</span>)
axis <span class="string">equal</span>

figure()
plotGrid(G2)
plotGrid(G2,G2.cells.tag,<span class="string">'faceColor'</span>,<span class="string">'b'</span>)
title(<span class="string">'wellEps = 1/2'</span>)
axis <span class="string">equal</span>
</pre><pre class="codeoutput">Warning: DistMesh did not converge in maximum number of iterations. 
Warning: DistMesh did not converge in maximum number of iterations. 
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_05.png" alt=""> <img vspace="5" hspace="5" src="showOptionValuesPebiGrid_06.png" alt=""> <h2>ProtLayer<a name="5"></a></h2><p>Adds a protection layer around wells. The protection sites are place normal along the well path</p><pre class="codeinput">x = linspace(0.2,0.8);
y = 0.5+0.1*sin(pi*x);
w = {[x',y']};
gS = 0.1;
pdims=[1,1];
G = pebiGrid(gS, pdims,<span class="string">'wellLines'</span>,w,<span class="string">'protLayer'</span>,true);

figure()
plotGrid(G);
hold <span class="string">on</span>
plotGrid(G,G.cells.tag,<span class="string">'facecolor'</span>,<span class="string">'b'</span>)
title(<span class="string">'Protection Layer on'</span>)
axis <span class="string">equal</span>
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_07.png" alt=""> <h2>protD<a name="6"></a></h2><p>This parameter sets the distance from the protection sites to the well path. This is cellarray of functions, one for each well path.</p><pre class="codeinput">w = {[0.2,0.8;0.8,0.8],<span class="keyword">...</span>
     [0.5,0.2;0.1,0.5]};
gS = 0.1;
pdims=[1,1];
protD = {@(p)0.01+0.1*p(:,1), @(p) 0.01*ones(size(p,1),1)};
G = pebiGrid(gS, pdims,<span class="string">'wellLines'</span>,w,<span class="string">'protLayer'</span>,true,<span class="string">'protD'</span>,protD);

figure()
plotGrid(G);
hold <span class="string">on</span>
plotGrid(G,G.cells.tag,<span class="string">'facecolor'</span>,<span class="string">'b'</span>)
title(<span class="string">'Specifying Protection Distance'</span>)
axis <span class="string">equal</span>
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_08.png" alt=""> <h2>faultLines<a name="7"></a></h2><p>This sets the faults in our reservoir. The wells are stored as a cell array, each element corresponding to one fault</p><pre class="codeinput">f = {[0.2,0.8;0.5,0.7;0.8,0.8],<span class="keyword">...</span>
     [0.5,0.2;0.1,0.5]};
gS = 0.1;
pdims=[1,1];
figure()
G = pebiGrid(gS, pdims,<span class="string">'faultLines'</span>,f);
plotGrid(G);
hold <span class="string">on</span>
plotFaces(G,G.faces.tag,<span class="string">'edgeColor'</span>,<span class="string">'r'</span>)
title(<span class="string">'Fault Lines'</span>)
axis <span class="string">equal</span>
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_09.png" alt=""> <h2>faultGridFactor<a name="8"></a></h2><p>The faultGridFactor sets the relative distance between the fault cells along the fault paths. If fautlGridFactor=0.5 the fault cells will be have spaceing about half the size of the reservoir cells:</p><pre class="codeinput">f = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
G1 = pebiGrid(gS, pdims,<span class="string">'faultLines'</span>,f,<span class="string">'faultGridFactor'</span>,1);
G2 = pebiGrid(gS, pdims,<span class="string">'faultLines'</span>,f,<span class="string">'faultGridFactor'</span>,1/2);

figure()
plotGrid(G1)
title(<span class="string">'faultGridFactor=1'</span>)
axis <span class="string">equal</span>
figure()
plotGrid(G2)
title(<span class="string">'faultGridFactor=1/2'</span>)
axis <span class="string">equal</span>
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_10.png" alt=""> <img vspace="5" hspace="5" src="showOptionValuesPebiGrid_11.png" alt=""> <h2>circleFactor<a name="9"></a></h2><p>The fault sites are generated by setting placing a set of circles along the fault path with a distance gS*faultGridFactor. The radius of the circles are gS*faultGridFactor*circleFactor. The fault sites are place at the intersection of these circles. Notice that in the second example, the fault is not traced by edges in the grid. This is because the distance between fault sites becomes so large that distmesh managed to force reservoir sites between the fault sites.</p><pre class="codeinput">f = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
G1 = pebiGrid(gS, pdims,<span class="string">'faultLines'</span>,f,<span class="string">'circleFactor'</span>,0.55);
G2 = pebiGrid(gS, pdims,<span class="string">'faultLines'</span>,f,<span class="string">'circleFactor'</span>,0.9);

figure()
plotGrid(G1)
title(<span class="string">'circleFactor=0.55'</span>)
axis <span class="string">equal</span>
figure()
plotGrid(G2)
title(<span class="string">'circleFactor=0.9'</span>)
axis <span class="string">equal</span>
</pre><pre class="codeoutput">Warning: DistMesh did not converge in maximum number of iterations. 
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_12.png" alt=""> <img vspace="5" hspace="5" src="showOptionValuesPebiGrid_13.png" alt=""> <h2>faultRho<a name="10"></a></h2><p>A function that sets the relative size of the fault sites in the domain.</p><pre class="codeinput">f = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
faultRho = @(p) 1 - 0.9*p(:,1);
G = pebiGrid(gS, pdims,<span class="string">'faultLines'</span>,f,<span class="string">'faultRho'</span>,faultRho);

figure()
plotGrid(G)
title(<span class="string">'faultRho=@(p) 1 - 0.9*p(:,1)'</span>)
axis <span class="string">equal</span>
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_14.png" alt=""> <h2>faultRefinement<a name="11"></a></h2><p>faultRefinement is a logical parameter which is set to true if we whish the grid to be refined towards the fault. NOTE: faultRefinement is not thoroughly together with wellrefinement!</p><pre class="codeinput">f = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
G = pebiGrid(gS, pdims,<span class="string">'faultLines'</span>,f,<span class="string">'faultGridFactor'</span>,1/4,<span class="string">'faultRefinement'</span>,true);

figure()
plotGrid(G)
plotGrid(G,G.cells.tag,<span class="string">'faceColor'</span>,<span class="string">'b'</span>)
title(<span class="string">'Fault Refinement'</span>)
axis <span class="string">equal</span>
</pre><pre class="codeoutput">Warning: DistMesh did not converge in maximum number of iterations. 
Warning: Empty cell selection in 'plotGrid'.  No graphics for you. 
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_15.png" alt=""> <h2>faultEps<a name="12"></a></h2><p>faultEps controlls the refinement towards the faults. The cell sizes are increasing exponentially away from the faults: exp(dist(x,fault)/faultEps). Notice that you have to scale faultEps to your reservoir size, or distMesh might take a very long time to converge.</p><pre class="codeinput">f = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
eps1 = 1/5;
eps2 = 1/2;
G1 = pebiGrid(gS, pdims,<span class="string">'faultLines'</span>,f,<span class="string">'faultGridFactor'</span>,1/4, <span class="keyword">...</span>
              <span class="string">'faultRefinement'</span>,true,<span class="string">'faultEps'</span>,eps1);
G2 = pebiGrid(gS, pdims,<span class="string">'faultLines'</span>,f,<span class="string">'faultGridFactor'</span>,1/4, <span class="keyword">...</span>
              <span class="string">'faultRefinement'</span>,true,<span class="string">'faultEps'</span>,eps2);


figure()
plotGrid(G1)
plotGrid(G1,G1.cells.tag,<span class="string">'faceColor'</span>,<span class="string">'b'</span>)
title(<span class="string">'wellEps = 1/5'</span>)
axis <span class="string">equal</span>

figure()
plotGrid(G2)
plotGrid(G2,G2.cells.tag,<span class="string">'faceColor'</span>,<span class="string">'b'</span>)
title(<span class="string">'wellEps = 1/2'</span>)
axis <span class="string">equal</span>
</pre><pre class="codeoutput">Warning: DistMesh did not converge in maximum number of iterations. 
Warning: DistMesh did not converge in maximum number of iterations. 
Warning: Empty cell selection in 'plotGrid'.  No graphics for you. 
Warning: Empty cell selection in 'plotGrid'.  No graphics for you. 
</pre><img vspace="5" hspace="5" src="showOptionValuesPebiGrid_16.png" alt=""> <img vspace="5" hspace="5" src="showOptionValuesPebiGrid_17.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Example
% In this example we show all optional options for pebiGrid.

%% wellLines
% This sets the wells in our reservoir. The wells are stored as a cell
% array, each element corresponding to one well
w = {[0.2,0.8;0.5,0.7;0.8,0.8],...
     [0.5,0.2]};
gS = 0.1;
pdims=[1,1];
G = pebiGrid(gS, pdims,'wellLines',w);

plotGrid(G);
hold on
plotGrid(G,G.cells.tag,'facecolor','b')
title('Two wells')
axis equal
%% wellGridFactor
% The wellGridFactor sets the relative size of the well cells. If
% wellGridFactor=0.5 the well cells will have about half the size of the
% reservoir sites:
w = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
G1 = pebiGrid(gS, pdims,'wellLines',w,'wellGridFactor',1);
G2 = pebiGrid(gS, pdims,'wellLines',w,'wellGridFactor',1/2);

figure()
plotGrid(G1)
plotGrid(G1,G1.cells.tag,'faceColor','b')
title('wellGridFactor=1')
axis equal
figure()
plotGrid(G2)
plotGrid(G2,G2.cells.tag,'faceColor','b')
title('wellGridFactor=1/2')
axis equal




%% wellRefinement
% wellRefinement is a logical parameter which is set to true if we whish
% the grid to be refined towards the wells.
w = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
G = pebiGrid(gS, pdims,'wellLines',w,'wellGridFactor',1/4,'wellRefinement',true);

figure()
plotGrid(G)
plotGrid(G,G.cells.tag,'faceColor','b')
title('wellRefinement')
axis equal


%% wellEps
% wellEps controlls the refinement towards the wells. The cell sizes are
% increasing exponentially away from the wells: exp(dist(x,well)/wellEps).
% Notice that you have to scale wellEps to your reservoir size, or distMesh
% might take a very long time to converge.
w = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
eps1 = 1/5;
eps2 = 1/2;
G1 = pebiGrid(gS, pdims,'wellLines',w,'wellGridFactor',1/4, ...
              'wellRefinement',true,'wellEps',eps1);
G2 = pebiGrid(gS, pdims,'wellLines',w,'wellGridFactor',1/4, ...
              'wellRefinement',true,'wellEps',eps2);

figure()
plotGrid(G1)
plotGrid(G1,G1.cells.tag,'faceColor','b')
title('wellEps = 1/5')
axis equal

figure()
plotGrid(G2)
plotGrid(G2,G2.cells.tag,'faceColor','b')
title('wellEps = 1/2')
axis equal


%% ProtLayer
% Adds a protection layer around wells. The protection sites are place
% normal along the well path
x = linspace(0.2,0.8);
y = 0.5+0.1*sin(pi*x);
w = {[x',y']};
gS = 0.1;
pdims=[1,1];
G = pebiGrid(gS, pdims,'wellLines',w,'protLayer',true);

figure()
plotGrid(G);
hold on
plotGrid(G,G.cells.tag,'facecolor','b')
title('Protection Layer on')
axis equal

%% protD
% This parameter sets the distance from the protection sites to the well
% path. This is cellarray of functions, one for each well path.
w = {[0.2,0.8;0.8,0.8],...
     [0.5,0.2;0.1,0.5]};
gS = 0.1;
pdims=[1,1];
protD = {@(p)0.01+0.1*p(:,1), @(p) 0.01*ones(size(p,1),1)};
G = pebiGrid(gS, pdims,'wellLines',w,'protLayer',true,'protD',protD);

figure()
plotGrid(G);
hold on
plotGrid(G,G.cells.tag,'facecolor','b')
title('Specifying Protection Distance')
axis equal



%% faultLines
% This sets the faults in our reservoir. The wells are stored as a cell
% array, each element corresponding to one fault
f = {[0.2,0.8;0.5,0.7;0.8,0.8],...
     [0.5,0.2;0.1,0.5]};
gS = 0.1;
pdims=[1,1];
figure()
G = pebiGrid(gS, pdims,'faultLines',f);
plotGrid(G);
hold on
plotFaces(G,G.faces.tag,'edgeColor','r')
title('Fault Lines')
axis equal


%% faultGridFactor
% The faultGridFactor sets the relative distance between the fault cells 
% along the fault paths. If fautlGridFactor=0.5 the fault cells will be 
% have spaceing about half the size of the reservoir cells:
f = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
G1 = pebiGrid(gS, pdims,'faultLines',f,'faultGridFactor',1);
G2 = pebiGrid(gS, pdims,'faultLines',f,'faultGridFactor',1/2);

figure()
plotGrid(G1)
title('faultGridFactor=1')
axis equal
figure()
plotGrid(G2)
title('faultGridFactor=1/2')
axis equal

%% circleFactor
% The fault sites are generated by setting placing a set of circles along
% the fault path with a distance gS*faultGridFactor. The radius of the
% circles are gS*faultGridFactor*circleFactor. The fault sites are place
% at the intersection of these circles. Notice that in the second example,
% the fault is not traced by edges in the grid. This is because the
% distance between fault sites becomes so large that distmesh managed to
% force reservoir sites between the fault sites. 
f = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
G1 = pebiGrid(gS, pdims,'faultLines',f,'circleFactor',0.55);
G2 = pebiGrid(gS, pdims,'faultLines',f,'circleFactor',0.9);

figure()
plotGrid(G1)
title('circleFactor=0.55')
axis equal
figure()
plotGrid(G2)
title('circleFactor=0.9')
axis equal

%% faultRho
% A function that sets the relative size of the fault sites in the domain.
f = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
faultRho = @(p) 1 - 0.9*p(:,1);
G = pebiGrid(gS, pdims,'faultLines',f,'faultRho',faultRho);

figure()
plotGrid(G)
title('faultRho=@(p) 1 - 0.9*p(:,1)')
axis equal


%% faultRefinement
% faultRefinement is a logical parameter which is set to true if we whish
% the grid to be refined towards the fault. NOTE: faultRefinement is not
% thoroughly together with wellrefinement! 
f = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
G = pebiGrid(gS, pdims,'faultLines',f,'faultGridFactor',1/4,'faultRefinement',true);

figure()
plotGrid(G)
plotGrid(G,G.cells.tag,'faceColor','b')
title('Fault Refinement')
axis equal


%% faultEps
% faultEps controlls the refinement towards the faults. The cell sizes are
% increasing exponentially away from the faults: exp(dist(x,fault)/faultEps).
% Notice that you have to scale faultEps to your reservoir size, or distMesh
% might take a very long time to converge.
f = {[0.2,0.3;0.8,0.7]};
gS = 0.1;
pdims=[1,1];
eps1 = 1/5;
eps2 = 1/2;
G1 = pebiGrid(gS, pdims,'faultLines',f,'faultGridFactor',1/4, ...
              'faultRefinement',true,'faultEps',eps1);
G2 = pebiGrid(gS, pdims,'faultLines',f,'faultGridFactor',1/4, ...
              'faultRefinement',true,'faultEps',eps2);


figure()
plotGrid(G1)
plotGrid(G1,G1.cells.tag,'faceColor','b')
title('wellEps = 1/5')
axis equal

figure()
plotGrid(G2)
plotGrid(G2,G2.cells.tag,'faceColor','b')
title('wellEps = 1/2')
axis equal
##### SOURCE END #####
--></body></html>